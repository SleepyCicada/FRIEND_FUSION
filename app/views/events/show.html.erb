<hr>
<div class="container mt-5 text-center">

  <h1 class="display-5 fw-bold mb-3"><%= @event.title %></h1>

  <% if @event.description.present? %>
    <p class="lead text-muted mb-4">
      <%= @event.description %>
    </p>
  <% end %>

  <div id="map" style="height: 400px; width: 100%; border-radius: 8px;"></div>

  <p class="lead text-muted mb-4">
    <strong><%= @event.title %></strong>.
  </p>

  <%= link_to register(@event), class: "btn btn-success btn-lg px-4 py-2 shadow-sm text-white" do %>
    <i class="bi bi-lightning-fill me-2"></i> Register
  <% end %>
</div>

<div class="mt-4">
  <h4 class="mb-3">Conversation Starters ğŸ’¬</h4>

  <!-- Button to trigger the AI call -->
  <%= button_to "Generate Starters",
        conversation_starters_event_path(@event),
        method: :get,
        form: { data: { turbo_stream: true } },
        class: "btn btn-secondary",
        id: "starter-button" %>

  <!-- Spinner (hidden by default) -->
  <div id="starter-loading" class="text-muted mt-2" style="display:none;">
    <div class="spinner-border spinner-border-sm"></div>
    Generating ideas...
  </div>

  <!-- Placeholder where AI starters will appear -->
  <div id="conversation-starters" class="mt-3"></div>
</div>

<script>
  document.addEventListener("turbo:before-fetch-request", (e) => {
    const target = e.target;

    // Only for conversation starter button
    if (target.id === "starter-button") {
      document.getElementById("starter-loading").style.display = "block";
    }
  });
</script>
